<% content_for :page_title do %>
  <%= link_to Spree.t('admin.cms.all_pages'), spree.admin_cms_pages_path %> / <%= @cms_page.title %>
<% end %>

<% content_for :page_actions do %>
  <%= page_preview_link(@cms_page) %>
<% end %>

<%= render partial: 'spree/admin/shared/error_messages', locals: { target: @cms_page } %>
<%= form_for [:admin, @cms_page], as: :cms_page, url: spree.admin_cms_page_path do |f| %>
  <%= render partial: 'form', locals: { f: f } %>
<% end %>

<% if @cms_page.sections? %>
  <div id="pageSectionsArea" class="col-12">

    <hr class="mt-5 hide-on-full-screen-mode">
    <div class="row">
      <div class="col d-flex justify-content-start">
        <%= button_link_to Spree.t('admin.cms.add_new_section'), spree.new_admin_cms_page_cms_section_path(@cms_page), icon: 'add.svg', class: 'no-wrap btn btn-success align-self-center' %>
      </div>
      <div class="col d-flex justify-content-end">
        <div id="LiveViewSwitcher" class="btn-group btn-group-toggle" data-toggle="buttons">
          <label class="btn btn-outline-primary active">
            <input type="radio" name="options" id="mobileLiveView" autocomplete="off"> Mobile
          </label>
          <label class="btn btn-outline-primary">
            <input type="radio" name="options" id="tabletLiveView" autocomplete="off"> Tablet
          </label>
          <label class="btn btn-outline-primary">
            <input type="radio" name="options" id="desktopLiveView" autocomplete="off" checked> Desktop
          </label>
        </div>

        <div class="ml-2">
            <button id="cmsSectionEditorFullScreen" type="button" class="btn btn-outline-primary no-wrap" data-toggle="button" autocomplete="off">Full Screen Mode</button>
        </div>
      </div>
    </div>
    <div class="row no-gutters">
      <div class="col-12 col-md-4 bg-light border border-right-0">
        <% if @cms_page.cms_sections.any? %>
          <div id="cmsPagesectionsArea" class="card-body row m-0 p-0 no-gutters">
            <% @cms_page.cms_sections.each do |section| %>
              <%= build_page_section(section) %>
            <% end %>
          </div>

        <% else %>
          <div class="row">
            <div class="col-12">
              <div class="alert alert-info no-objects-found m-4">
                <%= Spree.t('admin.cms.no_sections_found_please_add_one') %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <div class="d-none d-md-block col-8 bg-secondary border">
        <div id="liveViewCont" class="desktopLiveView">
          <div class="embed-responsive embed-responsive-4by3">
            <iframe class="embed-responsive-item"
                    id="pageLivePreview"
                    src="<%= preview_url(@cms_page) %>"
                    sandbox="allow-same-origin allow-forms allow-popups allow-scripts allow-modals">
            </iframe>
          </div>
        </div>
      </div>

    </div>
  </div>
<% end %>
